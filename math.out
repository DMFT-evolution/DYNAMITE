RowBox[{RowBox[{"scratch1", "=", "\"/media/jlang/Desk SSD/\""}], ";"}]
RowBox[{RowBox[{"scratch2", "=", "\"/nobackups/jlang/\""}], ";"}]
RowBox[{RowBox[{"paramnames", "=", RowBox[{"Union", "[", RowBox[{RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch1", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new2\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_HPC\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"Clear", "[", "loadparams", "]"}], ";"}]
RowBox[{RowBox[{RowBox[{"loadparams", "[", "file_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", "params", "}"}], ",", RowBox[{RowBox[{"Clear", "[", "T0", "]"}], ";", RowBox[{"params", "=", RowBox[{"Import", "[", "file", "]"}]}], ";", RowBox[{"Clear", "@@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], ")"}]}], ";", RowBox[{RowBox[{"Evaluate", "[", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], "]"}], "]"}], "=", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", RowBox[{"Append", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], ";", RowBox[{"len", "=", RowBox[{"Round", "[", "len", "]"}]}], ";", RowBox[{"ord", "=", RowBox[{"Round", "[", "ord", "]"}]}], ";", RowBox[{"method", "=", RowBox[{"Round", "[", "method", "]"}]}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"bsearch", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Complex", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "0"}]}], "}"}], ",", RowBox[{RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Floor", "[", RowBox[{RowBox[{"(", RowBox[{"n0", "+", "n1"}], ")"}], "/", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "==", "elem"}], ",", RowBox[{"Return", "[", "m", "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Min", "[", RowBox[{RowBox[{"m", "+", "1"}], ",", RowBox[{"Length", "[", "list", "]"}]}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "+", "1"}]}], "]"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Max", "[", RowBox[{RowBox[{"m", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "-", "1"}]}], "]"}]}], "]"}]}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"diff", ":=", RowBox[{RowBox[{RowBox[{"Rest", "[", "#", "]"}], "-", RowBox[{"Most", "[", "#", "]"}]}], "&"}]}], ";"}]
RowBox[{RowBox[{RowBox[{"\[Theta]func", "[", "x_", "]"}], ":=", RowBox[{"SetPrecision", "[", RowBox[{RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Delta]", "=", RowBox[{"1", "/", RowBox[{"(", RowBox[{"10", "\[Pi]", "Tmax"}], ")"}]}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Eta]", "=", RowBox[{"Rationalize", "[", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{"1", "/", "len"}], ")"}]}], "2", RowBox[{"ProductLog", "[", RowBox[{RowBox[{"-", "1"}], ",", RowBox[{RowBox[{"-", "\[Pi]"}], "\[Delta]"}]}], "]"}]}], "]"}]}], "}"}], ",", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"x", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}], "-", RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}]}], ")"}]}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}], "]"}]}], "-", RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}]}], "\[Eta]"}], ")"}]}], "]"}]}]}], ")"}]}]}], "]"}]}], "]"}], ",", "40"}], "]"}]}], ";"}]
RowBox[{"bsearchPosSorted", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "1"}], ",", RowBox[{"Lm", "=", "1."}], ",", RowBox[{"El", "=", "1."}]}], "}"}], ",", RowBox[{"Table", "[", RowBox[{RowBox[{RowBox[{"El", "=", RowBox[{"elem", "[", RowBox[{"[", "l", "]"}], "]"}]}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "El"}], ",", RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Quotient", "[", RowBox[{RowBox[{"n0", "+", "n1"}], ",", "2"}], "]"}]}], ";", RowBox[{"Lm", "=", RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "==", "El"}], ",", RowBox[{"n0", "=", "m"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<", "El"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}]}], "]"}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<=", "El"}], ",", RowBox[{"m", "+", RowBox[{"If", "[", RowBox[{RowBox[{"m", "==", RowBox[{"Length", "[", "list", "]"}]}], ",", "0.", ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "+", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}]}], "]"}]}], ",", RowBox[{"m", "-", RowBox[{"If", "[", RowBox[{RowBox[{"m", ">", "1"}], ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "-", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}], ",", "0."}], "]"}]}]}], "]"}]}], ",", RowBox[{"{", RowBox[{"l", ",", RowBox[{"Length", "[", "elem", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}], ",", RowBox[{"RuntimeOptions", "->", "\"Speed\""}]}], "]"}]}]
RowBox[{RowBox[{"scratch1", "=", "\"/media/jlang/Desk SSD/\""}], ";"}]
RowBox[{RowBox[{"scratch2", "=", "\"/nobackups/jlang/\""}], ";"}]
RowBox[{RowBox[{"paramnames", "=", RowBox[{"Union", "[", RowBox[{RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch1", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new2\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_HPC\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"Clear", "[", "loadparams", "]"}], ";"}]
RowBox[{RowBox[{RowBox[{"loadparams", "[", "file_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", "params", "}"}], ",", RowBox[{RowBox[{"Clear", "[", "T0", "]"}], ";", RowBox[{"params", "=", RowBox[{"Import", "[", "file", "]"}]}], ";", RowBox[{"Clear", "@@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], ")"}]}], ";", RowBox[{RowBox[{"Evaluate", "[", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], "]"}], "]"}], "=", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", RowBox[{"Append", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], ";", RowBox[{"len", "=", RowBox[{"Round", "[", "len", "]"}]}], ";", RowBox[{"ord", "=", RowBox[{"Round", "[", "ord", "]"}]}], ";", RowBox[{"method", "=", RowBox[{"Round", "[", "method", "]"}]}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"bsearch", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Complex", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "0"}]}], "}"}], ",", RowBox[{RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Floor", "[", RowBox[{RowBox[{"(", RowBox[{"n0", "+", "n1"}], ")"}], "/", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "==", "elem"}], ",", RowBox[{"Return", "[", "m", "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Min", "[", RowBox[{RowBox[{"m", "+", "1"}], ",", RowBox[{"Length", "[", "list", "]"}]}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "+", "1"}]}], "]"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Max", "[", RowBox[{RowBox[{"m", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "-", "1"}]}], "]"}]}], "]"}]}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"diff", ":=", RowBox[{RowBox[{RowBox[{"Rest", "[", "#", "]"}], "-", RowBox[{"Most", "[", "#", "]"}]}], "&"}]}], ";"}]
RowBox[{RowBox[{RowBox[{"\[Theta]func", "[", "x_", "]"}], ":=", RowBox[{"SetPrecision", "[", RowBox[{RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Delta]", "=", RowBox[{"1", "/", RowBox[{"(", RowBox[{"10", "\[Pi]", "Tmax"}], ")"}]}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Eta]", "=", RowBox[{"Rationalize", "[", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{"1", "/", "len"}], ")"}]}], "2", RowBox[{"ProductLog", "[", RowBox[{RowBox[{"-", "1"}], ",", RowBox[{RowBox[{"-", "\[Pi]"}], "\[Delta]"}]}], "]"}]}], "]"}]}], "}"}], ",", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"x", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}], "-", RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}]}], ")"}]}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}], "]"}]}], "-", RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}]}], "\[Eta]"}], ")"}]}], "]"}]}]}], ")"}]}]}], "]"}]}], "]"}], ",", "40"}], "]"}]}], ";"}]
RowBox[{"bsearchPosSorted", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "1"}], ",", RowBox[{"Lm", "=", "1."}], ",", RowBox[{"El", "=", "1."}]}], "}"}], ",", RowBox[{"Table", "[", RowBox[{RowBox[{RowBox[{"El", "=", RowBox[{"elem", "[", RowBox[{"[", "l", "]"}], "]"}]}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "El"}], ",", RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Quotient", "[", RowBox[{RowBox[{"n0", "+", "n1"}], ",", "2"}], "]"}]}], ";", RowBox[{"Lm", "=", RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "==", "El"}], ",", RowBox[{"n0", "=", "m"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<", "El"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}]}], "]"}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<=", "El"}], ",", RowBox[{"m", "+", RowBox[{"If", "[", RowBox[{RowBox[{"m", "==", RowBox[{"Length", "[", "list", "]"}]}], ",", "0.", ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "+", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}]}], "]"}]}], ",", RowBox[{"m", "-", RowBox[{"If", "[", RowBox[{RowBox[{"m", ">", "1"}], ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "-", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}], ",", "0."}], "]"}]}]}], "]"}]}], ",", RowBox[{"{", RowBox[{"l", ",", RowBox[{"Length", "[", "elem", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}], ",", RowBox[{"RuntimeOptions", "->", "\"Speed\""}]}], "]"}]}]
RowBox[{RowBox[{"loadLibrary", ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"libname", "=", RowBox[{"\"Interpol-mt.\"", "<>", RowBox[{"Switch", "[", RowBox[{"$OperatingSystem", ",", "\"Unix\"", ",", "\"so\"", ",", "\"Windows\"", ",", "\"dll\"", ",", "\"MacOSX\"", ",", "\"dylib\""}], "]"}]}]}], ",", "filename"}], "}"}], ",", RowBox[{RowBox[{"filename", "=", RowBox[{"FileNames", "[", RowBox[{"libname", ",", RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Length", "[", "filename", "]"}], "!=", "0"}], ",", RowBox[{RowBox[{"filename", "=", RowBox[{"filename", "[", RowBox[{"[", "1", "]"}], "]"}]}], ";", RowBox[{"Quiet", "[", RowBox[{RowBox[{RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Head", "[", "#", "]"}], "===", "LibraryFunction"}], ",", RowBox[{"LibraryFunctionUnload", "[", "#", "]"}]}], "]"}], "&"}], "/@", RowBox[{"Unevaluated", "[", RowBox[{"{", RowBox[{"build", ",", "clearAll", ",", "clearOne", ",", "append", ",", "deleteN", ",", "replace", ",", "replaceD", ",", "prod2", ",", "clip", ",", "output", ",", "getLast", ",", "conv", ",", "index", ",", "indexVec", ",", "indexVecN", ",", "indexVecLN", ",", "Interpol1D3c", ",", "indexVecR", ",", "indexVecR2", ",", "indexVecL", ",", "indexMat", ",", "indexMatN", ",", "indexMatN3", ",", "indexMatAll", ",", "indexMatMerge", ",", "\[CapitalSigma]Rnum", ",", "\[CapitalSigma]Knum"}], "}"}], "]"}]}], ";"}], "]"}], ";", RowBox[{"build", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"build\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"buildOne", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"buildOne\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", "Integer"}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clearAll", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clearAll\"", ",", RowBox[{"{", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clearOne", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clearOne\"", ",", RowBox[{"{", "Integer", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"append", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"append\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"deleteN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"deleteN\"", ",", RowBox[{"{", "Integer", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"replace", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"replace\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"replaceD", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"replaceD\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"output", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"output\"", ",", RowBox[{"{", "Integer", "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"getLast", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"getLast\"", ",", RowBox[{"{", RowBox[{"Integer", ",", "Integer"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"prod2", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"prod2\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clip", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clip\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"\[CapitalSigma]Rnum", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"sigmaR\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"\[CapitalSigma]Knum", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"sigmaK\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"conv", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"conv\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"index", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"index\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVec", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVec\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"indexVecR", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecR\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecR2", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecR2\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecL", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecL\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecLN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecLN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"Interpol1D3c", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"Interpol1D3c\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"indexMat", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMat\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatN3", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatN3\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatAll", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatAll\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatMerge", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatMerge\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", RowBox[{"Clear", "[", RowBox[{"build", ",", "buildOne", ",", "clearAll", ",", "clearOne", ",", "deleteN", ",", "append", ",", "replace", ",", "replaceD", ",", "output", ",", "getLast", ",", "conv", ",", "index", ",", "indexVec", ",", "indexVecN", ",", "indexVecLN", ",", "Interpol1D3c", ",", "indexVecR", ",", "indexVecR2", ",", "indexVecL", ",", "indexMat", ",", "indexMatN", ",", "indexMatN3", ",", "indexMatAll", ",", "indexMatMerge"}], "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "conv", "]"}]}], ",", RowBox[{RowBox[{"conv", "[", RowBox[{"int_", ",", "m1_", ",", "m2_"}], "]"}], ":=", RowBox[{RowBox[{"(", RowBox[{"m1", "*", "m2"}], ")"}], ".", "int"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "index", "]"}]}], ",", RowBox[{RowBox[{"index", "[", RowBox[{"list_", ",", "inds_"}], "]"}], ":=", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecL", "]"}]}], ",", RowBox[{RowBox[{"indexVecL", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecL3", "]"}]}], ",", RowBox[{RowBox[{"indexVecL3", "[", RowBox[{"list_", ",", "weightsIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"weights", "=", RowBox[{"ArrayReshape", "[", RowBox[{"weightsIn", ",", RowBox[{"{", RowBox[{RowBox[{"len", "^", "2"}], ",", RowBox[{RowBox[{"Length", "[", "weightsIn", "]"}], "/", RowBox[{"len", "^", "2"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weights", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "n"}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weights", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVec", "]"}]}], ",", RowBox[{RowBox[{"indexVec", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecR", "]"}]}], ",", RowBox[{RowBox[{"indexVecR", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecR2", "]"}]}], ",", RowBox[{RowBox[{"indexVecR2", "[", RowBox[{"list_", ",", "dlist_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_", ",", "\[Delta]tratio_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}]}], ")"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"(", RowBox[{"\[CapitalDelta]xvecIn", "-", RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}]}], ")"}], "*", RowBox[{"dlist", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMat", "]"}]}], ",", RowBox[{RowBox[{"indexMat", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "\[CapitalDelta]yvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"\[CapitalDelta]yvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]yvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "len"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"len", "+", "1"}], ")"}]}], "]"}], "]"}]}]}], ")"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMat3", "]"}]}], ",", RowBox[{RowBox[{"indexMat3", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "weightsyIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"weightsy", "=", RowBox[{"ArrayReshape", "[", RowBox[{"weightsyIn", ",", RowBox[{"{", RowBox[{RowBox[{"len", "^", "2"}], ",", RowBox[{RowBox[{"Length", "[", "weightsyIn", "]"}], "/", RowBox[{"len", "^", "2"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weightsy", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "n"}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weightsy", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weightsy", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"n", "+", "len"}], ")"}]}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weightsy", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMatMerge", "]"}]}], ",", RowBox[{RowBox[{"indexMatMerge", "[", RowBox[{"list_", ",", "defaultlist_", ",", "\[CapitalDelta]xvecIn_", ",", "\[CapitalDelta]yvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"mask", "=", RowBox[{"Subtract", "[", RowBox[{"1", ",", RowBox[{"UnitStep", "[", RowBox[{"-", "indsIn"}], "]"}]}], "]"}]}], ",", RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"\[CapitalDelta]yvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]yvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{"mask", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "len"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"len", "+", "1"}], ")"}]}], "]"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{"1", "-", "mask"}], ")"}], "defaultlist"}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"scratch1", "=", "\"/media/jlang/Desk SSD/\""}], ";"}]
RowBox[{RowBox[{"scratch2", "=", "\"/nobackups/jlang/\""}], ";"}]
RowBox[{RowBox[{"paramnames", "=", RowBox[{"Union", "[", RowBox[{RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch1", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new2\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_HPC\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"Clear", "[", "loadparams", "]"}], ";"}]
RowBox[{RowBox[{RowBox[{"loadparams", "[", "file_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", "params", "}"}], ",", RowBox[{RowBox[{"Clear", "[", "T0", "]"}], ";", RowBox[{"params", "=", RowBox[{"Import", "[", "file", "]"}]}], ";", RowBox[{"Clear", "@@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], ")"}]}], ";", RowBox[{RowBox[{"Evaluate", "[", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], "]"}], "]"}], "=", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", RowBox[{"Append", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], ";", RowBox[{"len", "=", RowBox[{"Round", "[", "len", "]"}]}], ";", RowBox[{"ord", "=", RowBox[{"Round", "[", "ord", "]"}]}], ";", RowBox[{"method", "=", RowBox[{"Round", "[", "method", "]"}]}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"bsearch", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Complex", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "0"}]}], "}"}], ",", RowBox[{RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Floor", "[", RowBox[{RowBox[{"(", RowBox[{"n0", "+", "n1"}], ")"}], "/", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "==", "elem"}], ",", RowBox[{"Return", "[", "m", "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Min", "[", RowBox[{RowBox[{"m", "+", "1"}], ",", RowBox[{"Length", "[", "list", "]"}]}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "+", "1"}]}], "]"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Max", "[", RowBox[{RowBox[{"m", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "-", "1"}]}], "]"}]}], "]"}]}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"diff", ":=", RowBox[{RowBox[{RowBox[{"Rest", "[", "#", "]"}], "-", RowBox[{"Most", "[", "#", "]"}]}], "&"}]}], ";"}]
RowBox[{RowBox[{RowBox[{"\[Theta]func", "[", "x_", "]"}], ":=", RowBox[{"SetPrecision", "[", RowBox[{RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Delta]", "=", RowBox[{"1", "/", RowBox[{"(", RowBox[{"10", "\[Pi]", "Tmax"}], ")"}]}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Eta]", "=", RowBox[{"Rationalize", "[", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{"1", "/", "len"}], ")"}]}], "2", RowBox[{"ProductLog", "[", RowBox[{RowBox[{"-", "1"}], ",", RowBox[{RowBox[{"-", "\[Pi]"}], "\[Delta]"}]}], "]"}]}], "]"}]}], "}"}], ",", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"x", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}], "-", RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}]}], ")"}]}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}], "]"}]}], "-", RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}]}], "\[Eta]"}], ")"}]}], "]"}]}]}], ")"}]}]}], "]"}]}], "]"}], ",", "40"}], "]"}]}], ";"}]
RowBox[{RowBox[{"bsearchPosSorted", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "1"}], ",", RowBox[{"Lm", "=", "1."}], ",", RowBox[{"El", "=", "1."}]}], "}"}], ",", RowBox[{"Table", "[", RowBox[{RowBox[{RowBox[{"El", "=", RowBox[{"elem", "[", RowBox[{"[", "l", "]"}], "]"}]}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "El"}], ",", RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Quotient", "[", RowBox[{RowBox[{"n0", "+", "n1"}], ",", "2"}], "]"}]}], ";", RowBox[{"Lm", "=", RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "==", "El"}], ",", RowBox[{"n0", "=", "m"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<", "El"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}]}], "]"}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<=", "El"}], ",", RowBox[{"m", "+", RowBox[{"If", "[", RowBox[{RowBox[{"m", "==", RowBox[{"Length", "[", "list", "]"}]}], ",", "0.", ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "+", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}]}], "]"}]}], ",", RowBox[{"m", "-", RowBox[{"If", "[", RowBox[{RowBox[{"m", ">", "1"}], ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "-", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}], ",", "0."}], "]"}]}]}], "]"}]}], ",", RowBox[{"{", RowBox[{"l", ",", RowBox[{"Length", "[", "elem", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}], ",", RowBox[{"RuntimeOptions", "->", "\"Speed\""}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"loadLibrary", ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"libname", "=", RowBox[{"\"Interpol-mt.\"", "<>", RowBox[{"Switch", "[", RowBox[{"$OperatingSystem", ",", "\"Unix\"", ",", "\"so\"", ",", "\"Windows\"", ",", "\"dll\"", ",", "\"MacOSX\"", ",", "\"dylib\""}], "]"}]}]}], ",", "filename"}], "}"}], ",", RowBox[{RowBox[{"filename", "=", RowBox[{"FileNames", "[", RowBox[{"libname", ",", RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Length", "[", "filename", "]"}], "!=", "0"}], ",", RowBox[{RowBox[{"filename", "=", RowBox[{"filename", "[", RowBox[{"[", "1", "]"}], "]"}]}], ";", RowBox[{"Quiet", "[", RowBox[{RowBox[{RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Head", "[", "#", "]"}], "===", "LibraryFunction"}], ",", RowBox[{"LibraryFunctionUnload", "[", "#", "]"}]}], "]"}], "&"}], "/@", RowBox[{"Unevaluated", "[", RowBox[{"{", RowBox[{"build", ",", "clearAll", ",", "clearOne", ",", "append", ",", "deleteN", ",", "replace", ",", "replaceD", ",", "prod2", ",", "clip", ",", "output", ",", "getLast", ",", "conv", ",", "index", ",", "indexVec", ",", "indexVecN", ",", "indexVecLN", ",", "Interpol1D3c", ",", "indexVecR", ",", "indexVecR2", ",", "indexVecL", ",", "indexMat", ",", "indexMatN", ",", "indexMatN3", ",", "indexMatAll", ",", "indexMatMerge", ",", "\[CapitalSigma]Rnum", ",", "\[CapitalSigma]Knum"}], "}"}], "]"}]}], ";"}], "]"}], ";", RowBox[{"build", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"build\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"buildOne", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"buildOne\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", "Integer"}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clearAll", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clearAll\"", ",", RowBox[{"{", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clearOne", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clearOne\"", ",", RowBox[{"{", "Integer", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"append", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"append\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"deleteN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"deleteN\"", ",", RowBox[{"{", "Integer", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"replace", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"replace\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"replaceD", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"replaceD\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"output", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"output\"", ",", RowBox[{"{", "Integer", "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"getLast", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"getLast\"", ",", RowBox[{"{", RowBox[{"Integer", ",", "Integer"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"prod2", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"prod2\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clip", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clip\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"\[CapitalSigma]Rnum", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"sigmaR\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"\[CapitalSigma]Knum", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"sigmaK\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"conv", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"conv\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"index", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"index\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVec", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVec\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"indexVecR", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecR\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecR2", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecR2\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecL", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecL\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecLN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecLN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"Interpol1D3c", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"Interpol1D3c\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"indexMat", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMat\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatN3", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatN3\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatAll", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatAll\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatMerge", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatMerge\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", RowBox[{"Clear", "[", RowBox[{"build", ",", "buildOne", ",", "clearAll", ",", "clearOne", ",", "deleteN", ",", "append", ",", "replace", ",", "replaceD", ",", "output", ",", "getLast", ",", "conv", ",", "index", ",", "indexVec", ",", "indexVecN", ",", "indexVecLN", ",", "Interpol1D3c", ",", "indexVecR", ",", "indexVecR2", ",", "indexVecL", ",", "indexMat", ",", "indexMatN", ",", "indexMatN3", ",", "indexMatAll", ",", "indexMatMerge"}], "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "conv", "]"}]}], ",", RowBox[{RowBox[{"conv", "[", RowBox[{"int_", ",", "m1_", ",", "m2_"}], "]"}], ":=", RowBox[{RowBox[{"(", RowBox[{"m1", "*", "m2"}], ")"}], ".", "int"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "index", "]"}]}], ",", RowBox[{RowBox[{"index", "[", RowBox[{"list_", ",", "inds_"}], "]"}], ":=", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecL", "]"}]}], ",", RowBox[{RowBox[{"indexVecL", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecL3", "]"}]}], ",", RowBox[{RowBox[{"indexVecL3", "[", RowBox[{"list_", ",", "weightsIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"weights", "=", RowBox[{"ArrayReshape", "[", RowBox[{"weightsIn", ",", RowBox[{"{", RowBox[{RowBox[{"len", "^", "2"}], ",", RowBox[{RowBox[{"Length", "[", "weightsIn", "]"}], "/", RowBox[{"len", "^", "2"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weights", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "n"}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weights", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVec", "]"}]}], ",", RowBox[{RowBox[{"indexVec", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecR", "]"}]}], ",", RowBox[{RowBox[{"indexVecR", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecR2", "]"}]}], ",", RowBox[{RowBox[{"indexVecR2", "[", RowBox[{"list_", ",", "dlist_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_", ",", "\[Delta]tratio_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}]}], ")"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"(", RowBox[{"\[CapitalDelta]xvecIn", "-", RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}]}], ")"}], "*", RowBox[{"dlist", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMat", "]"}]}], ",", RowBox[{RowBox[{"indexMat", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "\[CapitalDelta]yvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"\[CapitalDelta]yvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]yvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "len"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"len", "+", "1"}], ")"}]}], "]"}], "]"}]}]}], ")"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMat3", "]"}]}], ",", RowBox[{RowBox[{"indexMat3", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "weightsyIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"weightsy", "=", RowBox[{"ArrayReshape", "[", RowBox[{"weightsyIn", ",", RowBox[{"{", RowBox[{RowBox[{"len", "^", "2"}], ",", RowBox[{RowBox[{"Length", "[", "weightsyIn", "]"}], "/", RowBox[{"len", "^", "2"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weightsy", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "n"}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weightsy", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weightsy", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"n", "+", "len"}], ")"}]}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weightsy", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMatMerge", "]"}]}], ",", RowBox[{RowBox[{"indexMatMerge", "[", RowBox[{"list_", ",", "defaultlist_", ",", "\[CapitalDelta]xvecIn_", ",", "\[CapitalDelta]yvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"mask", "=", RowBox[{"Subtract", "[", RowBox[{"1", ",", RowBox[{"UnitStep", "[", RowBox[{"-", "indsIn"}], "]"}]}], "]"}]}], ",", RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"\[CapitalDelta]yvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]yvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{"mask", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "len"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"len", "+", "1"}], ")"}]}], "]"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{"1", "-", "mask"}], ")"}], "defaultlist"}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"posB1x", "=", RowBox[{"bsearchPosSorted", "[", RowBox[{"t1grid", ",", RowBox[{RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}], "\[Theta]points"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"\[Delta]tratio", "=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"diff", "=", RowBox[{"diff", "[", "t1grid", "]"}]}], "}"}], ",", RowBox[{"Join", "[", RowBox[{RowBox[{"{", RowBox[{"0.", ",", "0."}], "}"}], ",", RowBox[{RowBox[{"Rest", "[", "diff", "]"}], "/", RowBox[{"Most", "[", "diff", "]"}]}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"i", "=", "309"}], ";"}]
RowBox[{RowBox[{"loadparams", "[", RowBox[{"paramnames", "[", RowBox[{"[", "i", "]"}], "]"}], "]"}], ";"}]
RowBox[{RowBox[{"dir", "=", RowBox[{"FileNameTake", "[", RowBox[{RowBox[{"paramnames", "[", RowBox[{"[", "i", "]"}], "]"}], ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"Print", "[", "dir", "]"}], ";"}]
/nobackups/jlang/Results_new2/3_6_2025_1808_p=2.0_p2=9.0_lambda=0.60_T0=Infin\
 
  ity
RowBox[{RowBox[{"QK0", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK0.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR0", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QR0.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"energy", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"Energy.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QK", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QR.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"rvec", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"rvec.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"t1grid", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"t1grid.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"QK0", "[", RowBox[{"[", "1", "]"}], "]"}], "==", "0."}], ",", RowBox[{RowBox[{"QK0", "[", RowBox[{"[", "1", "]"}], "]"}], "=", "1."}]}], "]"}], ";"}]
RowBox[{RowBox[{"end", "=", RowBox[{RowBox[{"Position", "[", RowBox[{RowBox[{"Append", "[", RowBox[{RowBox[{"Sign", "[", RowBox[{"diff", "[", "QK0", "]"}], "]"}], ",", "1"}], "]"}], ",", "1", ",", "1"}], "]"}], "[", RowBox[{"[", RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"end", "!=", RowBox[{"Length", "[", "t1grid", "]"}]}], ",", RowBox[{"end", "=", RowBox[{"bsearch", "[", RowBox[{"t1grid", ",", RowBox[{".8", RowBox[{"t1grid", "[", RowBox[{"[", "end", "]"}], "]"}]}]}], "]"}]}]}], "]"}], ";"}]
RowBox[{RowBox[{"t1grid", "=", RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QK0", "=", RowBox[{"QK0", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR0", "=", RowBox[{"QR0", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QK", "=", RowBox[{"QK", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR", "=", RowBox[{"QR", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"energy", "=", RowBox[{"energy", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"rvec", "=", RowBox[{"rvec", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"\[Theta]points", "=", RowBox[{"\[Theta]func", "[", RowBox[{"Range", "[", "len", "]"}], "]"}]}], ";"}]
RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}]
RowBox[{RowBox[{"posB1x", "=", RowBox[{"bsearchPosSorted", "[", RowBox[{"t1grid", ",", RowBox[{RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}], "\[Theta]points"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"\[Delta]tratio", "=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"diff", "=", RowBox[{"diff", "[", "t1grid", "]"}]}], "}"}], ",", RowBox[{"Join", "[", RowBox[{RowBox[{"{", RowBox[{"0.", ",", "0."}], "}"}], ",", RowBox[{RowBox[{"Rest", "[", "diff", "]"}], "/", RowBox[{"Most", "[", "diff", "]"}]}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"floor", "=", RowBox[{"Clip", "[", RowBox[{RowBox[{"Floor", "[", "posB1x", "]"}], ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"Max", "[", RowBox[{RowBox[{RowBox[{"Ceiling", "[", RowBox[{"Max", "[", "posB1x", "]"}], "]"}], "-", "1"}], ",", "1"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"diff", "=", RowBox[{"Subtract", "[", RowBox[{"floor", ",", "posB1x"}], "]"}]}], "}"}], ",", RowBox[{"indexVecN", "[", RowBox[{"len", ",", "diff", ",", "floor", ",", "\[Delta]tratio", ",", "QKB1int", ",", "QRB1int"}], "]"}]}], "]"}]}], "]"}]
RowBox[{"loadLibrary", "[", "]"}]
RowBox[{RowBox[{"scratch1", "=", "\"/media/jlang/Desk SSD/\""}], ";"}]
RowBox[{RowBox[{"scratch2", "=", "\"/nobackups/jlang/\""}], ";"}]
RowBox[{RowBox[{"paramnames", "=", RowBox[{"Union", "[", RowBox[{RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch1", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_new2\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}], ",", RowBox[{"FileNames", "[", RowBox[{"\"params*\"", ",", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"scratch2", ",", "\"Results_HPC\""}], "}"}], "]"}], ",", "2", ",", RowBox[{"IgnoreCase", "->", "False"}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"Clear", "[", "loadparams", "]"}], ";"}]
RowBox[{RowBox[{RowBox[{"loadparams", "[", "file_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", "params", "}"}], ",", RowBox[{RowBox[{"Clear", "[", "T0", "]"}], ";", RowBox[{"params", "=", RowBox[{"Import", "[", "file", "]"}]}], ";", RowBox[{"Clear", "@@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], ")"}]}], ";", RowBox[{RowBox[{"Evaluate", "[", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTrim", "[", "#", "]"}], "&"}], "/@", RowBox[{"(", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{"Prepend", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", "0"}], "]"}], "+", "1"}], ",", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "1"}]}], "}"}], "]"}]}], ")"}]}], "]"}], "]"}], "=", RowBox[{"ToExpression", "[", RowBox[{RowBox[{RowBox[{"StringTake", "[", RowBox[{"params", ",", "#"}], "]"}], "&"}], "/@", RowBox[{"Transpose", "[", RowBox[{"{", RowBox[{RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"=\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], "+", "1"}], ",", RowBox[{"Append", "[", RowBox[{RowBox[{RowBox[{"StringPosition", "[", RowBox[{"params", ",", "\"\\n\""}], "]"}], "[", RowBox[{"[", RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", RowBox[{"-", "1"}]}], "]"}]}], "}"}], "]"}]}], "]"}]}], ";", RowBox[{"len", "=", RowBox[{"Round", "[", "len", "]"}]}], ";", RowBox[{"ord", "=", RowBox[{"Round", "[", "ord", "]"}]}], ";", RowBox[{"method", "=", RowBox[{"Round", "[", "method", "]"}]}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"bsearch", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Complex", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "0"}]}], "}"}], ",", RowBox[{RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Floor", "[", RowBox[{RowBox[{"(", RowBox[{"n0", "+", "n1"}], ")"}], "/", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "==", "elem"}], ",", RowBox[{"Return", "[", "m", "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "elem"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Min", "[", RowBox[{RowBox[{"m", "+", "1"}], ",", RowBox[{"Length", "[", "list", "]"}]}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "+", "1"}]}], "]"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "-", "elem"}], "]"}], "<=", RowBox[{"Abs", "[", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"Max", "[", RowBox[{RowBox[{"m", "-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], "-", "elem"}], "]"}]}], ",", "m", ",", RowBox[{"m", "-", "1"}]}], "]"}]}], "]"}]}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"diff", ":=", RowBox[{RowBox[{RowBox[{"Rest", "[", "#", "]"}], "-", RowBox[{"Most", "[", "#", "]"}]}], "&"}]}], ";"}]
RowBox[{RowBox[{RowBox[{"\[Theta]func", "[", "x_", "]"}], ":=", RowBox[{"SetPrecision", "[", RowBox[{RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Delta]", "=", RowBox[{"1", "/", RowBox[{"(", RowBox[{"10", "\[Pi]", "Tmax"}], ")"}]}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"\[Eta]", "=", RowBox[{"Rationalize", "[", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{"1", "/", "len"}], ")"}]}], "2", RowBox[{"ProductLog", "[", RowBox[{RowBox[{"-", "1"}], ",", RowBox[{RowBox[{"-", "\[Pi]"}], "\[Delta]"}]}], "]"}]}], "]"}]}], "}"}], ",", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"x", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}], "-", RowBox[{"(", RowBox[{"1", "-", RowBox[{RowBox[{"(", RowBox[{"2", "/", "\[Pi]"}], ")"}], RowBox[{"ArcTan", "[", RowBox[{"1", "/", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}]}], "]"}]}]}], ")"}]}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}], "\[Eta]"}], ")"}]}], "]"}]}], "-", RowBox[{RowBox[{"1", "/", "\[Pi]"}], "2", RowBox[{"ArcTan", "[", RowBox[{"E", "^", RowBox[{"(", RowBox[{RowBox[{"-", RowBox[{"(", RowBox[{RowBox[{"len", "/", "2"}], "-", RowBox[{"1", "/", "2"}]}], ")"}]}], "\[Eta]"}], ")"}]}], "]"}]}]}], ")"}]}]}], "]"}]}], "]"}], ",", "40"}], "]"}]}], ";"}]
RowBox[{RowBox[{"bsearchPosSorted", "=", RowBox[{"Compile", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"list", ",", "_Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"elem", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"n0", "=", "1"}], ",", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ",", RowBox[{"m", "=", "1"}], ",", RowBox[{"Lm", "=", "1."}], ",", RowBox[{"El", "=", "1."}]}], "}"}], ",", RowBox[{"Table", "[", RowBox[{RowBox[{RowBox[{"El", "=", RowBox[{"elem", "[", RowBox[{"[", "l", "]"}], "]"}]}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}], "<", "El"}], ",", RowBox[{"While", "[", RowBox[{RowBox[{"n0", "<=", "n1"}], ",", RowBox[{RowBox[{"m", "=", RowBox[{"Quotient", "[", RowBox[{RowBox[{"n0", "+", "n1"}], ",", "2"}], "]"}]}], ";", RowBox[{"Lm", "=", RowBox[{"list", "[", RowBox[{"[", "m", "]"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "==", "El"}], ",", RowBox[{"n0", "=", "m"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<", "El"}], ",", RowBox[{"n0", "=", RowBox[{"m", "+", "1"}]}], ",", RowBox[{"n1", "=", RowBox[{"m", "-", "1"}]}]}], "]"}]}]}], "]"}]}], "]"}], ";", RowBox[{"n1", "=", RowBox[{"Length", "[", "list", "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"Lm", "<=", "El"}], ",", RowBox[{"m", "+", RowBox[{"If", "[", RowBox[{RowBox[{"m", "==", RowBox[{"Length", "[", "list", "]"}]}], ",", "0.", ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "+", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}]}], "]"}]}], ",", RowBox[{"m", "-", RowBox[{"If", "[", RowBox[{RowBox[{"m", ">", "1"}], ",", RowBox[{RowBox[{"(", RowBox[{"El", "-", "Lm"}], ")"}], "/", RowBox[{"(", RowBox[{RowBox[{"list", "[", RowBox[{"[", RowBox[{"m", "-", "1"}], "]"}], "]"}], "-", "Lm"}], ")"}]}], ",", "0."}], "]"}]}]}], "]"}]}], ",", RowBox[{"{", RowBox[{"l", ",", RowBox[{"Length", "[", "elem", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", RowBox[{"RuntimeAttributes", "->", RowBox[{"{", "Listable", "}"}]}], ",", RowBox[{"CompilationTarget", "->", "\"C\""}], ",", RowBox[{"RuntimeOptions", "->", "\"Speed\""}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"loadLibrary", ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"libname", "=", RowBox[{"\"Interpol-mt.\"", "<>", RowBox[{"Switch", "[", RowBox[{"$OperatingSystem", ",", "\"Unix\"", ",", "\"so\"", ",", "\"Windows\"", ",", "\"dll\"", ",", "\"MacOSX\"", ",", "\"dylib\""}], "]"}]}]}], ",", "filename"}], "}"}], ",", RowBox[{RowBox[{"filename", "=", RowBox[{"FileNames", "[", RowBox[{"libname", ",", RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Length", "[", "filename", "]"}], "!=", "0"}], ",", RowBox[{RowBox[{"filename", "=", RowBox[{"filename", "[", RowBox[{"[", "1", "]"}], "]"}]}], ";", RowBox[{"Quiet", "[", RowBox[{RowBox[{RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Head", "[", "#", "]"}], "===", "LibraryFunction"}], ",", RowBox[{"LibraryFunctionUnload", "[", "#", "]"}]}], "]"}], "&"}], "/@", RowBox[{"Unevaluated", "[", RowBox[{"{", RowBox[{"build", ",", "clearAll", ",", "clearOne", ",", "append", ",", "deleteN", ",", "replace", ",", "replaceD", ",", "prod2", ",", "clip", ",", "output", ",", "getLast", ",", "conv", ",", "index", ",", "indexVec", ",", "indexVecN", ",", "indexVecLN", ",", "Interpol1D3c", ",", "indexVecR", ",", "indexVecR2", ",", "indexVecL", ",", "indexMat", ",", "indexMatN", ",", "indexMatN3", ",", "indexMatAll", ",", "indexMatMerge", ",", "\[CapitalSigma]Rnum", ",", "\[CapitalSigma]Knum"}], "}"}], "]"}]}], ";"}], "]"}], ";", RowBox[{"build", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"build\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"buildOne", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"buildOne\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", "Integer"}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clearAll", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clearAll\"", ",", RowBox[{"{", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clearOne", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clearOne\"", ",", RowBox[{"{", "Integer", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"append", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"append\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"deleteN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"deleteN\"", ",", RowBox[{"{", "Integer", "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"replace", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"replace\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"replaceD", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"replaceD\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"output", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"output\"", ",", RowBox[{"{", "Integer", "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"getLast", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"getLast\"", ",", RowBox[{"{", RowBox[{"Integer", ",", "Integer"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"prod2", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"prod2\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"clip", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"clip\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"\[CapitalSigma]Rnum", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"sigmaR\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"\[CapitalSigma]Knum", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"sigmaK\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"conv", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"conv\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"index", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"index\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVec", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVec\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"indexVecR", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecR\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecR2", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecR2\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecL", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecL\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexVecLN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexVecLN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"Interpol1D3c", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"Interpol1D3c\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", "\"Void\""}], "]"}]}]}], ";", RowBox[{"indexMat", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMat\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatN", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatN\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatN3", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatN3\"", ",", RowBox[{"{", RowBox[{"Integer", ",", RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatAll", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatAll\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3"}], "}"}]}], "]"}]}]}], ";", RowBox[{"indexMatMerge", "=", RowBox[{"Quiet", "@", RowBox[{"LibraryFunctionLoad", "[", RowBox[{"filename", ",", "\"indexMatMerge\"", ",", RowBox[{"{", RowBox[{RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "1", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "3", ",", "\"Shared\""}], "}"}], ",", RowBox[{"{", RowBox[{"Integer", ",", "2", ",", "\"Shared\""}], "}"}]}], "}"}], ",", RowBox[{"{", RowBox[{"Real", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", RowBox[{"Clear", "[", RowBox[{"build", ",", "buildOne", ",", "clearAll", ",", "clearOne", ",", "deleteN", ",", "append", ",", "replace", ",", "replaceD", ",", "output", ",", "getLast", ",", "conv", ",", "index", ",", "indexVec", ",", "indexVecN", ",", "indexVecLN", ",", "Interpol1D3c", ",", "indexVecR", ",", "indexVecR2", ",", "indexVecL", ",", "indexMat", ",", "indexMatN", ",", "indexMatN3", ",", "indexMatAll", ",", "indexMatMerge"}], "]"}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "conv", "]"}]}], ",", RowBox[{RowBox[{"conv", "[", RowBox[{"int_", ",", "m1_", ",", "m2_"}], "]"}], ":=", RowBox[{RowBox[{"(", RowBox[{"m1", "*", "m2"}], ")"}], ".", "int"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "index", "]"}]}], ",", RowBox[{RowBox[{"index", "[", RowBox[{"list_", ",", "inds_"}], "]"}], ":=", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecL", "]"}]}], ",", RowBox[{RowBox[{"indexVecL", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecL3", "]"}]}], ",", RowBox[{RowBox[{"indexVecL3", "[", RowBox[{"list_", ",", "weightsIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"weights", "=", RowBox[{"ArrayReshape", "[", RowBox[{"weightsIn", ",", RowBox[{"{", RowBox[{RowBox[{"len", "^", "2"}], ",", RowBox[{RowBox[{"Length", "[", "weightsIn", "]"}], "/", RowBox[{"len", "^", "2"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weights", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "n"}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weights", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVec", "]"}]}], ",", RowBox[{RowBox[{"indexVec", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecR", "]"}]}], ",", RowBox[{RowBox[{"indexVecR", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexVecR2", "]"}]}], ",", RowBox[{RowBox[{"indexVecR2", "[", RowBox[{"list_", ",", "dlist_", ",", "\[CapitalDelta]xvecIn_", ",", "indsIn_", ",", "\[Delta]tratio_"}], "]"}], ":=", RowBox[{RowBox[{RowBox[{"(", RowBox[{"1", "-", RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}]}], ")"}], "*", RowBox[{"list", "[", RowBox[{"[", "indsIn", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"(", RowBox[{"\[CapitalDelta]xvecIn", "-", RowBox[{"\[CapitalDelta]xvecIn", "^", "2"}]}], ")"}], "*", RowBox[{"dlist", "[", RowBox[{"[", RowBox[{"indsIn", "+", "1"}], "]"}], "]"}]}]}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMat", "]"}]}], ",", RowBox[{RowBox[{"indexMat", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "\[CapitalDelta]yvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"\[CapitalDelta]yvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]yvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "len"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"len", "+", "1"}], ")"}]}], "]"}], "]"}]}]}], ")"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMat3", "]"}]}], ",", RowBox[{RowBox[{"indexMat3", "[", RowBox[{"list_", ",", "\[CapitalDelta]xvecIn_", ",", "weightsyIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"weightsy", "=", RowBox[{"ArrayReshape", "[", RowBox[{"weightsyIn", ",", RowBox[{"{", RowBox[{RowBox[{"len", "^", "2"}], ",", RowBox[{RowBox[{"Length", "[", "weightsyIn", "]"}], "/", RowBox[{"len", "^", "2"}]}]}], "}"}]}], "]"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weightsy", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "n"}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weightsy", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"Sum", "[", RowBox[{RowBox[{RowBox[{"weightsy", "[", RowBox[{"[", RowBox[{"All", ",", RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"n", "+", "len"}], ")"}]}], "]"}], "]"}]}], ",", RowBox[{"{", RowBox[{"n", ",", "0", ",", RowBox[{RowBox[{"Length", "[", RowBox[{"weightsy", "[", RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[{"ValueQ", "[", "indexMatMerge", "]"}]}], ",", RowBox[{RowBox[{"indexMatMerge", "[", RowBox[{"list_", ",", "defaultlist_", ",", "\[CapitalDelta]xvecIn_", ",", "\[CapitalDelta]yvecIn_", ",", "indsIn_"}], "]"}], ":=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"mask", "=", RowBox[{"Subtract", "[", RowBox[{"1", ",", RowBox[{"UnitStep", "[", RowBox[{"-", "indsIn"}], "]"}]}], "]"}]}], ",", RowBox[{"inds", "=", RowBox[{"Flatten", "[", "indsIn", "]"}]}], ",", RowBox[{"\[CapitalDelta]xvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]xvecIn"}]}], ",", RowBox[{"\[CapitalDelta]yvec", "=", RowBox[{RowBox[{RowBox[{"Flatten", "[", "#", "]"}], "&"}], "/@", "\[CapitalDelta]yvecIn"}]}]}], "}"}], ",", RowBox[{"ArrayReshape", "[", RowBox[{RowBox[{RowBox[{"mask", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", "inds", "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "1"}], "]"}], "]"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]xvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"(", RowBox[{RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "1", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", "len"}], "]"}], "]"}]}], "+", RowBox[{RowBox[{"\[CapitalDelta]yvec", "[", RowBox[{"[", "2", "]"}], "]"}], "*", RowBox[{"list", "[", RowBox[{"[", RowBox[{"inds", "+", RowBox[{"(", RowBox[{"len", "+", "1"}], ")"}]}], "]"}], "]"}]}]}], ")"}]}]}], ")"}]}], "+", RowBox[{RowBox[{"(", RowBox[{"1", "-", "mask"}], ")"}], "defaultlist"}]}], ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{RowBox[{"buildLowMem", "[", RowBox[{"fac_", ":", "1"}], "]"}], ":=", RowBox[{"(", RowBox[{RowBox[{"buildOne", "[", RowBox[{"QK", ",", "1"}], "]"}], ";", RowBox[{"QK", "=", RowBox[{"QK", "[", RowBox[{"[", RowBox[{RowBox[{"-", "1"}], ";;", RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", RowBox[{"buildOne", "[", RowBox[{"QR", ",", "2"}], "]"}], ";", RowBox[{"QR", "=", RowBox[{"QR", "[", RowBox[{"[", RowBox[{RowBox[{"-", "1"}], ";;", RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", RowBox[{"buildOne", "[", RowBox[{RowBox[{"fac", "dQK"}], ",", "3"}], "]"}], ";", RowBox[{"dQK", "=", RowBox[{"dQK", "[", RowBox[{"[", RowBox[{RowBox[{"-", "1"}], ";;", RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", RowBox[{"buildOne", "[", RowBox[{RowBox[{"fac", "dQR"}], ",", "4"}], "]"}], ";", RowBox[{"dQR", "=", RowBox[{"dQR", "[", RowBox[{"[", RowBox[{RowBox[{"-", "1"}], ";;", RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], ")"}]}], ";"}]
RowBox[{RowBox[{"i", "=", "309"}], ";"}]
RowBox[{RowBox[{"loadparams", "[", RowBox[{"paramnames", "[", RowBox[{"[", "i", "]"}], "]"}], "]"}], ";"}]
RowBox[{RowBox[{"dir", "=", RowBox[{"FileNameTake", "[", RowBox[{RowBox[{"paramnames", "[", RowBox[{"[", "i", "]"}], "]"}], ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"Print", "[", "dir", "]"}], ";"}]
/nobackups/jlang/Results_new2/3_6_2025_1808_p=2.0_p2=9.0_lambda=0.60_T0=Infin\
 
  ity
RowBox[{RowBox[{"QK0", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK0.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR0", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QR0.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"energy", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"Energy.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QK", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QR.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"dQK", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"dQK.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"dQR", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"dQR.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"rvec", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"rvec.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"t1grid", "=", RowBox[{"Import", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"t1grid.wxf\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"QK0", "[", RowBox[{"[", "1", "]"}], "]"}], "==", "0."}], ",", RowBox[{RowBox[{"QK0", "[", RowBox[{"[", "1", "]"}], "]"}], "=", "1."}]}], "]"}], ";"}]
RowBox[{RowBox[{"end", "=", RowBox[{RowBox[{"Position", "[", RowBox[{RowBox[{"Append", "[", RowBox[{RowBox[{"Sign", "[", RowBox[{"diff", "[", "QK0", "]"}], "]"}], ",", "1"}], "]"}], ",", "1", ",", "1"}], "]"}], "[", RowBox[{"[", RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"If", "[", RowBox[{RowBox[{"end", "!=", RowBox[{"Length", "[", "t1grid", "]"}]}], ",", RowBox[{"end", "=", RowBox[{"bsearch", "[", RowBox[{"t1grid", ",", RowBox[{".8", RowBox[{"t1grid", "[", RowBox[{"[", "end", "]"}], "]"}]}]}], "]"}]}]}], "]"}], ";"}]
RowBox[{RowBox[{"t1grid", "=", RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QK0", "=", RowBox[{"QK0", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR0", "=", RowBox[{"QR0", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QK", "=", RowBox[{"QK", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"QR", "=", RowBox[{"QR", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"energy", "=", RowBox[{"energy", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"rvec", "=", RowBox[{"rvec", "[", RowBox[{"[", RowBox[{"1", ";;", "end"}], "]"}], "]"}]}], ";"}]
RowBox[{RowBox[{"\[Theta]points", "=", RowBox[{"\[Theta]func", "[", RowBox[{"Range", "[", "len", "]"}], "]"}]}], ";"}]
RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}]
RowBox[{RowBox[{"posB1x", "=", RowBox[{"bsearchPosSorted", "[", RowBox[{"t1grid", ",", RowBox[{RowBox[{"t1grid", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}], "\[Theta]points"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"\[Delta]tratio", "=", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"diff", "=", RowBox[{"diff", "[", "t1grid", "]"}]}], "}"}], ",", RowBox[{"Join", "[", RowBox[{RowBox[{"{", RowBox[{"0.", ",", "0."}], "}"}], ",", RowBox[{RowBox[{"Rest", "[", "diff", "]"}], "/", RowBox[{"Most", "[", "diff", "]"}]}]}], "]"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"loadLibrary", "[", "]"}], ";"}]
RowBox[{RowBox[{"buildLowMem", "[", "]"}], ";"}]
RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"floor", "=", RowBox[{"Clip", "[", RowBox[{RowBox[{"Floor", "[", "posB1x", "]"}], ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"Max", "[", RowBox[{RowBox[{RowBox[{"Ceiling", "[", RowBox[{"Max", "[", "posB1x", "]"}], "]"}], "-", "1"}], ",", "1"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"diff", "=", RowBox[{"Subtract", "[", RowBox[{"floor", ",", "posB1x"}], "]"}]}], "}"}], ",", RowBox[{"indexVecN", "[", RowBox[{"len", ",", "diff", ",", "floor", ",", "\[Delta]tratio", ",", "QKB1int", ",", "QRB1int"}], "]"}]}], "]"}]}], "]"}]
RowBox[{RowBox[{"QKB1int", "=", RowBox[{"ConstantArray", "[", RowBox[{"0.", ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], ";"}]
RowBox[{RowBox[{"QRB1int", "=", RowBox[{"ConstantArray", "[", RowBox[{"0.", ",", RowBox[{"{", RowBox[{"len", ",", "len"}], "}"}]}], "]"}]}], ";"}]
RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"floor", "=", RowBox[{"Clip", "[", RowBox[{RowBox[{"Floor", "[", "posB1x", "]"}], ",", RowBox[{"{", RowBox[{"1", ",", RowBox[{"Max", "[", RowBox[{RowBox[{RowBox[{"Ceiling", "[", RowBox[{"Max", "[", "posB1x", "]"}], "]"}], "-", "1"}], ",", "1"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"diff", "=", RowBox[{"Subtract", "[", RowBox[{"floor", ",", "posB1x"}], "]"}]}], "}"}], ",", RowBox[{"indexVecN", "[", RowBox[{"len", ",", "diff", ",", "floor", ",", "\[Delta]tratio", ",", "QKB1int", ",", "QRB1int"}], "]"}]}], "]"}]}], "]"}]
RowBox[{"Total", "[", RowBox[{"QKB1int", ",", "\[Infinity]"}], "]"}]
RowBox[{"QKB1int", "[", RowBox[{"[", "1", "]"}], "]"}]
RowBox[{"QKB1int", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}]
RowBox[{"ListPlot", "[", RowBox[{"QKB1int", "[", RowBox[{"[", RowBox[{"-", "1"}], "]"}], "]"}], "]"}]
RowBox[{RowBox[{"Export", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed.txt\""}], "}"}], "]"}], ",", "QKB1int"}], "]"}], ";"}]
RowBox[{"Export", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed.txt\""}], "}"}], "]"}], ",", "QKB1int"}], "]"}]
RowBox[{"Dimensions", "[", "QKB1int", "]"}]
RowBox[{"Export", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed.bin\""}], "}"}], "]"}], ",", "QKB1int"}], "]"}]
RowBox[{"Export", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed.h5\""}], "}"}], "]"}], ",", "QKB1int"}], "]"}]
RowBox[{"Export", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed.h5\""}], "}"}], "]"}], ",", "QKB1int", ",", "\"HDF5\"", ",", RowBox[{"\"CompressionLevel\"", "->", "9"}]}], "]"}]
RowBox[{RowBox[{"SaveCompressed", "[", RowBox[{"file_String", ",", RowBox[{"mat_", "?", "MatrixQ"}]}], "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"rows", "=", RowBox[{"Length", "[", "mat", "]"}]}], ",", RowBox[{"cols", "=", RowBox[{"Length", "[", RowBox[{"First", "@", "mat"}], "]"}]}], ",", "htype", ",", "s"}], "}"}], ",", RowBox[{RowBox[{"htype", "=", RowBox[{"If", "[", RowBox[{RowBox[{"$SystemWordLength", "==", "64"}], ",", "\"UnsignedInteger64\"", ",", "\"UnsignedInteger32\""}], "]"}]}], ";", RowBox[{"s", "=", RowBox[{"OpenWrite", "[", RowBox[{"file", ",", RowBox[{"BinaryFormat", "->", "True"}]}], "]"}]}], ";", RowBox[{"BinaryWrite", "[", RowBox[{"s", ",", "rows", ",", "htype", ",", RowBox[{"ByteOrdering", "->", RowBox[{"-", "1"}]}]}], "]"}], ";", RowBox[{"BinaryWrite", "[", RowBox[{"s", ",", "cols", ",", "htype", ",", RowBox[{"ByteOrdering", "->", RowBox[{"-", "1"}]}]}], "]"}], ";", RowBox[{"BinaryWrite", "[", RowBox[{"s", ",", RowBox[{"N", "@", RowBox[{"Flatten", "[", "mat", "]"}]}], ",", "\"Real64\"", ",", RowBox[{"ByteOrdering", "->", RowBox[{"-", "1"}]}]}], "]"}], ";", RowBox[{"Close", "[", "s", "]"}], ";"}]}], "]"}]}]
RowBox[{"SaveCompressed", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed\""}], "}"}], "]"}], ",", "QKB1int"}], "]"}]
RowBox[{RowBox[{"SaveCompressed", "[", RowBox[{RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed\""}], "}"}], "]"}], ",", "QKB1int"}], "]"}], ";"}]
RowBox[{RowBox[{"LoadCompressed", "[", "file_String", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"try", ",", "rows", ",", "cols", ",", "cnt", ",", "data", ",", "s", ",", "headerBytes", ",", "fileBytes"}], "}"}], ",", RowBox[{RowBox[{RowBox[{"try", "[", "htype_", "]"}], ":=", RowBox[{"Module", "[", RowBox[{RowBox[{"{", "}"}], ",", RowBox[{RowBox[{"s", "=", RowBox[{"OpenRead", "[", RowBox[{"file", ",", RowBox[{"BinaryFormat", "->", "True"}]}], "]"}]}], ";", RowBox[{"rows", "=", RowBox[{"BinaryRead", "[", RowBox[{"s", ",", "htype", ",", RowBox[{"ByteOrdering", "->", RowBox[{"-", "1"}]}]}], "]"}]}], ";", RowBox[{"cols", "=", RowBox[{"BinaryRead", "[", RowBox[{"s", ",", "htype", ",", RowBox[{"ByteOrdering", "->", RowBox[{"-", "1"}]}]}], "]"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"!", RowBox[{"IntegerQ", "[", "rows", "]"}]}], "||", RowBox[{"!", RowBox[{"IntegerQ", "[", "cols", "]"}]}], "||", RowBox[{"rows", "<=", "0"}], "||", RowBox[{"cols", "<=", "0"}]}], ",", RowBox[{RowBox[{"Close", "[", "s", "]"}], ";", RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", RowBox[{"headerBytes", "=", RowBox[{"2", "*", RowBox[{"If", "[", RowBox[{RowBox[{"htype", "===", "\"UnsignedInteger64\""}], ",", "8", ",", "4"}], "]"}]}]}], ";", RowBox[{"fileBytes", "=", RowBox[{"FileByteCount", "[", "file", "]"}]}], ";", RowBox[{"cnt", "=", RowBox[{"rows", "*", "cols"}]}], ";", RowBox[{"If", "[", RowBox[{RowBox[{"fileBytes", "<", RowBox[{"headerBytes", "+", RowBox[{"8", "cnt"}]}]}], ",", RowBox[{RowBox[{"Close", "[", "s", "]"}], ";", RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", RowBox[{"data", "=", RowBox[{"BinaryReadList", "[", RowBox[{"s", ",", "\"Real64\"", ",", "cnt", ",", RowBox[{"ByteOrdering", "->", RowBox[{"-", "1"}]}]}], "]"}]}], ";", RowBox[{"Close", "[", "s", "]"}], ";", RowBox[{"If", "[", RowBox[{RowBox[{RowBox[{"Length", "[", "data", "]"}], "==", "cnt"}], ",", RowBox[{"Partition", "[", RowBox[{"data", ",", "cols"}], "]"}], ",", "$Failed"}], "]"}]}]}], "]"}]}], ";", RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"m64", "=", RowBox[{"try", "[", "\"UnsignedInteger64\"", "]"}]}], "}"}], ",", RowBox[{"If", "[", RowBox[{RowBox[{"m64", "=!=", "$Failed"}], ",", "m64", ",", RowBox[{"try", "[", "\"UnsignedInteger32\"", "]"}]}], "]"}]}], "]"}]}]}], "]"}]}]
RowBox[{RowBox[{"QKcomp", "=", RowBox[{"LoadCompressed", "[", RowBox[{"FileNameJoin", "[", RowBox[{"{", RowBox[{"dir", ",", "\"QK_compressed\""}], "}"}], "]"}], "]"}]}], ";"}]
RowBox[{"QKcomp", "==", "QKB1int"}]
RowBox[{"Length", "[", RowBox[{"paramnames", "[", RowBox[{"[", "i", "]"}], "]"}], "]"}]
RowBox[{"Length", "[", "paramnames", "]"}]
